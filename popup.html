<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Shadow Intern</title>
  <link rel="stylesheet" href="shared-styles.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      width: 360px;
      margin: 0;
      padding: 0;
      font-family: var(--font-family);
      background: var(--bg);
      color: var(--fg);
      font-size: var(--font-size-base);
      overflow-x: hidden;
    }

    .container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Top Bar */
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border);
      background: var(--bg-card);
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .logo-icon {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    .logo-text {
      font-size: var(--font-size-md);
      font-weight: 600;
      color: var(--fg);
      letter-spacing: -0.01em;
    }

    .logo-text .accent {
      color: var(--emerald);
    }

    .status-pill {
      font-size: var(--font-size-xs);
      padding: 4px 10px;
      border-radius: var(--radius-full);
      background: var(--bg-hover);
      color: var(--fg-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
      border: 1px solid var(--border);
      white-space: nowrap;
    }

    .status-pill.active {
      background: var(--emerald-bg);
      color: var(--emerald);
      border-color: var(--emerald);
    }

    .status-pill.expired {
      background: rgba(239, 68, 68, 0.15);
      color: var(--error);
      border-color: var(--error);
    }

    .status-pill.loading {
      background: var(--bg-hover);
      color: var(--fg-muted);
      border-color: var(--border);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: var(--spacing-lg);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-lg);
    }

    /* Usage Card */
    .usage-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      box-shadow: var(--shadow-sm);
    }

    .usage-card.hidden {
      display: none;
    }

    .plan-label {
      font-size: var(--font-size-sm);
      color: var(--fg-muted);
      margin-bottom: var(--spacing-xs);
      font-weight: 500;
    }

    .plan-value {
      font-size: var(--font-size-lg);
      font-weight: 600;
      color: var(--fg);
      margin-bottom: var(--spacing-md);
      letter-spacing: -0.01em;
    }

    .remaining-section {
      margin-top: var(--spacing-md);
    }

    .remaining-label {
      font-size: var(--font-size-xs);
      color: var(--fg-muted);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      margin-bottom: var(--spacing-xs);
      font-weight: 600;
    }

    .remaining-value {
      font-size: var(--font-size-xl);
      font-weight: 700;
      color: var(--emerald);
      margin-bottom: var(--spacing-sm);
      letter-spacing: -0.02em;
    }

    .remaining-value.low {
      color: var(--warning);
    }

    .remaining-value.zero {
      color: var(--error);
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: var(--bg-hover);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin-top: var(--spacing-sm);
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--emerald), var(--emerald-hover));
      border-radius: var(--radius-full);
      transition: width var(--transition-base);
      box-shadow: 0 0 8px rgba(22, 163, 74, 0.3);
    }

    .progress-bar.low {
      background: linear-gradient(90deg, var(--warning), #fbbf24);
    }

    .progress-bar.zero {
      background: linear-gradient(90deg, var(--error), #f87171);
    }

    .offline-indicator {
      font-size: var(--font-size-xs);
      color: var(--fg-dim);
      margin-top: var(--spacing-sm);
      font-style: italic;
      text-align: center;
    }

    /* Quick Controls Card */
    .controls-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: var(--spacing-lg);
      box-shadow: var(--shadow-sm);
    }

    .controls-card.hidden {
      display: none;
    }

    .control-group {
      margin-bottom: var(--spacing-md);
    }

    .control-group:last-child {
      margin-bottom: 0;
    }

    .control-label {
      font-size: var(--font-size-xs);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--fg-muted);
      margin-bottom: var(--spacing-sm);
      display: block;
      font-weight: 600;
    }

    /* Dropdowns */
    select {
      width: 100%;
      font-size: var(--font-size-base);
      padding: 10px 12px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: var(--bg);
      color: var(--fg);
      transition: all var(--transition-base);
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a0a0a0' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      padding-right: 36px;
    }

    select:hover {
      border-color: var(--border-hover);
      background-color: var(--bg-hover);
    }

    select:focus {
      outline: none;
      border-color: var(--emerald);
      box-shadow: var(--shadow-emerald);
    }

    /* Reply Length Segmented Control */
    .length-segmented {
      display: flex;
      gap: var(--spacing-xs);
      background: var(--bg);
      padding: 4px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
    }

    button.length-segment {
      flex: 1;
      border-radius: var(--radius-sm);
      border: none;
      background: transparent;
      color: var(--fg-muted);
      padding: 8px 0;
      font-size: var(--font-size-sm);
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-base);
    }

    button.length-segment:hover {
      color: var(--fg);
      background: var(--bg-hover);
    }

    button.length-segment.active {
      background: var(--emerald);
      color: var(--bg);
      font-weight: 600;
      box-shadow: var(--shadow-sm);
    }

    /* Toggle Switch */
    .toggle-row {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      padding: var(--spacing-sm) 0;
    }

    .toggle-wrapper {
      position: relative;
      width: 44px;
      height: 24px;
      flex-shrink: 0;
    }

    input[type="checkbox"].toggle {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--bg-hover);
      border: 1px solid var(--border);
      border-radius: var(--radius-full);
      transition: all var(--transition-base);
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 2px;
      bottom: 2px;
      background-color: var(--fg-muted);
      border-radius: 50%;
      transition: all var(--transition-base);
    }

    input[type="checkbox"].toggle:checked + .toggle-slider {
      background-color: var(--emerald);
      border-color: var(--emerald);
    }

    input[type="checkbox"].toggle:checked + .toggle-slider:before {
      transform: translateX(20px);
      background-color: var(--fg);
    }

    .toggle-label {
      font-size: var(--font-size-base);
      color: var(--fg);
      cursor: pointer;
      user-select: none;
    }

    /* Empty/Error States */
    .empty-state {
      padding: var(--spacing-2xl);
      text-align: center;
      display: none;
    }

    .empty-state.visible {
      display: block;
    }

    .empty-state-icon {
      width: 48px;
      height: 48px;
      margin: 0 auto var(--spacing-md);
      opacity: 0.5;
    }

    .empty-state-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      color: var(--fg);
      margin-bottom: var(--spacing-sm);
    }

    .empty-state-message {
      font-size: var(--font-size-sm);
      color: var(--fg-muted);
      margin-bottom: var(--spacing-lg);
      line-height: 1.5;
    }

    /* Skeleton Loading */
    .skeleton {
      background: linear-gradient(90deg, var(--bg-hover) 25%, var(--bg-card) 50%, var(--bg-hover) 75%);
      background-size: 200% 100%;
      animation: loading 1.5s ease-in-out infinite;
      border-radius: var(--radius-sm);
    }

    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    .skeleton-text {
      height: 16px;
      margin-bottom: var(--spacing-sm);
    }

    .skeleton-text.large {
      height: 24px;
    }

    .skeleton-bar {
      height: 8px;
      border-radius: var(--radius-full);
    }

    /* Bottom Actions */
    .actions-section {
      padding: var(--spacing-lg);
      border-top: 1px solid var(--border);
      background: var(--bg-card);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }

    .action-button {
      width: 100%;
      padding: 12px 16px;
      border-radius: var(--radius-md);
      border: 1px solid var(--border);
      background: var(--bg);
      color: var(--fg);
      font-size: var(--font-size-base);
      font-weight: 500;
      cursor: pointer;
      transition: all var(--transition-base);
      text-align: center;
      text-decoration: none;
      display: block;
      font-family: var(--font-family);
    }

    .action-button:hover {
      background: var(--bg-hover);
      border-color: var(--border-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .action-button:active {
      transform: translateY(0);
    }

    .action-button.primary {
      background: var(--emerald);
      color: var(--bg);
      border-color: var(--emerald);
      font-weight: 600;
    }

    .action-button.primary:hover {
      background: var(--emerald-hover);
      border-color: var(--emerald-hover);
      box-shadow: 0 4px 12px rgba(22, 163, 74, 0.3);
    }

    .action-button.secondary {
      background: transparent;
      border-color: var(--emerald);
      color: var(--emerald);
    }

    .action-button.secondary:hover {
      background: var(--emerald-bg);
    }

    .action-button.tertiary {
      background: transparent;
      border: none;
      color: var(--fg-muted);
      font-size: var(--font-size-sm);
      padding: 8px 16px;
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    .action-button.tertiary:hover {
      color: var(--emerald);
      background: transparent;
      transform: none;
      box-shadow: none;
    }

    .action-button.hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="logo-section">
        <svg class="logo-icon" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M8 24.5C8 22.7 8.7 21 10.1 19.9L27.9 6.9C29.1 5.9 30.9 5.9 32.1 6.9L49.9 19.9C51.3 21 52 22.7 52 24.5V39.5C52 41.3 51.3 43 49.9 44.1L32.1 57.1C30.9 58.1 29.1 58.1 27.9 57.1L10.1 44.1C8.7 43 8 41.3 8 39.5V24.5Z" fill="#16A34A"/>
          <path d="M16 32C16 31.3 16.4 30.6 17.1 30.1L26.8 23.4C28.2 22.4 29.8 22.4 31.2 23.4L40.9 30.1C41.6 30.6 42 31.3 42 32C42 32.7 41.6 33.4 40.9 33.9L31.2 40.6C29.8 41.6 28.2 41.6 26.8 40.6L17.1 33.9C16.4 33.4 16 32.7 16 32Z" fill="#ECFDF5"/>
          <circle cx="32" cy="32" r="9" fill="#022C22"/>
          <path d="M32 24L33.4 29.4L38.5 32L33.4 34.6L32 40L30.6 34.6L25.5 32L30.6 29.4L32 24Z" fill="#FFFFFF"/>
        </svg>
        <span class="logo-text">Shadow <span class="accent">Intern</span></span>
      </div>
      <div class="status-pill loading" id="statusPill">LOADING</div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Skeleton Loading State -->
      <div class="usage-card" id="skeletonState">
        <div class="skeleton skeleton-text large" style="width: 60%; margin-bottom: 8px;"></div>
        <div class="skeleton skeleton-text" style="width: 40%; margin-bottom: 12px;"></div>
        <div class="skeleton skeleton-bar" style="width: 100%;"></div>
      </div>

      <!-- Usage Card -->
      <div class="usage-card hidden" id="usageCard">
        <div class="plan-label">Plan</div>
        <div class="plan-value" id="planValue">—</div>
        <div class="remaining-section">
          <div class="remaining-label">Remaining today</div>
          <div class="remaining-value" id="remainingValue">—</div>
          <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
          </div>
        </div>
        <div class="offline-indicator hidden" id="offlineIndicator">Offline</div>
      </div>

      <!-- Empty/Error States -->
      <div class="empty-state" id="emptyState">
        <svg class="empty-state-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
        </svg>
        <div class="empty-state-title" id="emptyStateTitle">Enter license key</div>
        <div class="empty-state-message" id="emptyStateMessage">Get started by entering your license key in settings.</div>
        <button class="action-button secondary" id="emptyStateCta">Enter license key</button>
      </div>

      <!-- Quick Controls Card -->
      <div class="controls-card hidden" id="controlsCard">
        <div class="control-group">
          <label class="control-label" for="personaSelect">Active Persona</label>
          <select id="personaSelect">
            <option value="">No persona (default)</option>
          </select>
        </div>

        <div class="control-group">
          <label class="control-label" for="toneSelect">Tone</label>
          <select id="toneSelect">
            <option value="neutral">Neutral</option>
            <option value="degen">Degen</option>
            <option value="professional">Professional</option>
            <option value="toxic">Toxic</option>
          </select>
        </div>

        <div class="control-group">
          <label class="control-label">Reply Length</label>
          <div class="length-segmented">
            <button class="length-segment" data-length="80">Short</button>
            <button class="length-segment" data-length="160">Medium</button>
            <button class="length-segment" data-length="240">Long</button>
          </div>
        </div>

        <div class="control-group">
          <div class="toggle-row">
            <div class="toggle-wrapper">
              <input type="checkbox" id="humanizeToggle" class="toggle">
              <span class="toggle-slider"></span>
            </div>
            <label for="humanizeToggle" class="toggle-label">Humanized replies</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom Actions -->
    <div class="actions-section">
      <button class="action-button primary" id="openXBtn">Open X</button>
      <button class="action-button secondary" id="openSettingsBtn">Full settings</button>
      <a href="https://t.me/shadowintern" target="_blank" class="action-button tertiary" id="supportLink">Support (Telegram)</a>
      <button class="action-button secondary hidden" id="upgradeBtn">Upgrade plan</button>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
